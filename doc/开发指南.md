# SSE Auto Translator - 开发指南

## 概述

本指南为希望为SSE Auto Translator (SSE-AT)项目做出贡献的开发者提供信息。它涵盖了开发环境设置、编码标准和贡献工作流程。

## 开发环境设置

### 先决条件

1. **Python 3.11+**
   - SSE-AT使用Python 3.11开发
   - 更新的版本可能可以工作，但不受官方支持

2. **Git**
   - 版本控制所需
   - 用于克隆仓库和管理更改

3. **Visual Studio Code**（推荐）
   - 首选的IDE
   - 项目设置包含在仓库中

### 设置环境

1. **克隆仓库**
   ```bash
   git clone https://github.com/cruldra/SSE-Auto-Translator.git
   cd SSE-Auto-Translator
   ```

2. **创建虚拟环境**
   ```bash
   python -m venv .venv
   ```

3. **激活虚拟环境**
   - Windows: `.venv\Scripts\activate`
   - Linux/macOS: `source .venv/bin/activate`

4. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

5. **运行应用程序**
   ```bash
   python src/app.py
   ```

### 构建应用程序

要构建独立的可执行文件：

1. **运行构建脚本**
   ```bash
   build.bat
   ```

2. **输出**
   - 可执行文件和所有依赖项都构建在`app.dist`文件夹中
   - 最终分发在`SSE-AT`文件夹中创建

## 项目结构

### 源代码组织

- **src/** - 主源代码
  - **app.py** - 入口点
  - **main.py** - 主应用程序类
  - **data/** - 应用程序数据
  - **database/** - 翻译数据库管理
  - **mod_managers/** - 模组管理器集成
  - **settings/** - 设置对话框组件
  - **startup_dialog/** - 首次设置组件
  - **translation_editor/** - 翻译编辑器组件
  - **translator_api/** - 翻译服务集成
  - **translation_provider/** - 翻译源管理
  - **utilities/** - 实用函数和类

### 关键文件

- **build.py** - 构建配置
- **requirements.txt** - Python依赖
- **update.json** - 更新信息
- **.gitignore** - Git忽略规则

## 编码标准

### Python风格指南

1. **PEP 8**
   - 遵循PEP 8风格指南
   - 使用4个空格进行缩进
   - 最大行长度为88个字符

2. **文档字符串**
   - 为所有类和函数使用文档字符串
   - 遵循Google文档字符串格式

3. **类型提示**
   - 为函数参数和返回值使用类型提示
   - 使用`typing`模块进行复杂类型

### Qt约定

1. **小部件命名**
   - 为小部件使用描述性名称
   - 遵循`<类型>_<目的>`模式（例如，`button_save`）

2. **信号连接**
   - 对于简单连接使用lambda函数
   - 对于复杂处理程序使用命名函数

3. **布局管理**
   - 使用布局管理器而不是固定定位
   - 优先使用垂直和水平布局

### 文件组织

1. **模块结构**
   - 每个模块应该有明确的责任
   - 相关功能应该分组在一起

2. **导入顺序**
   - 首先是标准库导入
   - 其次是第三方库导入
   - 最后是本地导入

3. **类结构**
   - 类属性在顶部
   - 构造函数和初始化方法其次
   - 公共方法后跟私有方法

## 贡献工作流程

### 问题跟踪

1. **错误报告**
   - 检查问题是否已存在
   - 提供详细的重现步骤
   - 包括错误消息和日志

2. **功能请求**
   - 描述功能及其好处
   - 提供如何使用它的示例
   - 考虑边缘情况和潜在问题

### 拉取请求

1. **分支命名**
   - 使用描述性分支名称
   - 遵循`<类型>/<描述>`模式（例如，`feature/add-translation-memory`）

2. **提交消息**
   - 编写清晰简洁的提交消息
   - 以现在时态的动词开始
   - 在适用时引用问题编号

3. **拉取请求描述**
   - 描述更改及其目的
   - 列出任何依赖或要求
   - 提及任何相关问题

### 代码审查

1. **审查过程**
   - 所有代码更改都需要审查
   - 及时处理审查评论
   - 在进行更改后请求重新审查

2. **测试**
   - 确保所有测试通过
   - 为新功能添加新测试
   - 验证应用程序按预期工作

## 测试

### 手动测试

1. **功能测试**
   - 测试所有功能和工作流程
   - 验证UI行为正确
   - 检查错误处理和边缘情况

2. **集成测试**
   - 测试与模组管理器的集成
   - 验证翻译应用正确
   - 检查与不同游戏版本的兼容性

### 自动化测试

1. **单元测试**
   - 为核心功能编写单元测试
   - 使用`unittest`框架
   - 在提交更改前运行测试

2. **UI测试**
   - 测试UI组件和交互
   - 验证UI正确响应用户输入
   - 检查数据更改时UI更新

## 文档

### 代码文档

1. **文档字符串**
   - 记录所有类和函数
   - 解释参数和返回值
   - 为复杂功能提供示例

2. **注释**
   - 使用注释解释复杂逻辑
   - 避免冗余注释
   - 保持注释与代码更改同步

### 用户文档

1. **说明**
   - 添加功能时更新用户说明
   - 提供清晰简洁的解释
   - 包括截图以便视觉指导

2. **本地化**
   - 为新文本更新本地化文件
   - 确保所有面向用户的文本都已本地化
   - 使用不同语言进行测试

## 发布流程

1. **版本编号**
   - 遵循语义版本控制（主要.次要.补丁）
   - 对于不兼容的更改增加主要版本
   - 对于新功能增加次要版本
   - 对于错误修复增加补丁版本

2. **发布准备**
   - 在`main.py`中更新版本号
   - 在`Changelog.md`中更新更新日志
   - 为自动更新程序更新`update.json`

3. **分发**
   - 使用`build.bat`构建应用程序
   - 创建`SSE-AT`文件夹的ZIP归档
   - 上传到GitHub发布和Nexus Mods

## 资源

- [GitHub仓库](https://github.com/cruldra/SSE-Auto-Translator)
- [Nexus Mods页面](https://www.nexusmods.com/skyrimspecialedition/mods/...)
- [Discord服务器](https://discord.gg/...)

## 许可证

SSE Auto Translator根据Attribution-NonCommercial-NoDerivatives 4.0 International许可证授权。有关详细信息，请参阅LICENSE文件。
